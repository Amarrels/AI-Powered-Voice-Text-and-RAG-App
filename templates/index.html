<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Book Knowledge App</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

  <div class="container">
    <div class="logo-header">
        <img src="{{ url_for('static', filename='BookApplogo.png') }}" alt="Book Logo">
    </div>
      
    <!-- Status Messages -->
    {% if status %}
      <div class="status-message">
        {% if status == 'book_error' %}
          <p class="status-error">❌ Invalid PDF. Please upload a .pdf file.</p>
        {% elif status == 'book_uploaded' %}
          <p class="status-success">✅ Book uploaded successfully!</p>
        {% elif status == 'no_book' %}
          <p class="status-error">⚠️ Please upload a book first.</p>
        {% elif status == 'audio_error' %}
          <p class="status-error">❌ Invalid audio. Upload a .wav file.</p>
        {% elif status == 'question_ok' %}
          <p class="status-success">✅ Question processed! See response below.</p>
        {% elif status == 'tts_error' %}
          <p class="status-error">⚠️ TTS generation failed.</p>
        {% endif %}
      </div>
    {% endif %}

    <section>
      <h2>📄 Upload Book (PDF)</h2>
      <form action="{{ url_for('upload_book') }}" method="post" enctype="multipart/form-data">
        <input type="file" name="book_pdf" accept=".pdf" required>
        <input type="submit" value="Upload Book">
      </form>
      {% if current_book %}
        <p><strong>Current book:</strong> {{ current_book }}</p>
      {% endif %}
    </section>

    <section>
      <h2>🎤 Record Your Question</h2>
      <button id="record">🎙️ Record</button>
      <button id="stop">⏹️ Stop</button>
      <span id="timer">00:00</span>
      <audio id="audio" controls></audio>
    </section>

    <section>
      <h2>📚 Available Books</h2>
      <ul>
        {% for file in pdf_files %}
          <li><a href="{{ url_for('serve_book', filename=file) }}" target="_blank">{{ file }}</a></li>
        {% endfor %}
      </ul>
    </section>

    <section>
      <h2>🗣️ Audio Queries</h2>
      <ul>
        {% for file in audio_files %}
          <li>
            <strong>{{ file }}</strong>
            <audio controls>
              <source src="{{ url_for('serve_audio', filename=file) }}">
              Audio not supported.
            </audio>
          </li>
        {% endfor %}
      </ul>
    </section>

    <section>
      <h2>🔊 TTS Responses</h2>
      <ul>
        {% for file in tts_files %}
          <li>
            <strong>{{ file }}</strong>
            <audio controls>
              <source src="{{ url_for('serve_tts', filename=file) }}">
              Audio not supported.
            </audio>
          </li>
        {% endfor %}
      </ul>
    </section>
  </div>

  <script src="{{ url_for('serve_script') }}"></script>
</body>
</html>
